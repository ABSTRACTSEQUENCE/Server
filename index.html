<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title></title>
</head>
<body>
	<style>
		table {
			margin: 10px;
			border: solid;
			border-block-color: black;
			border-width: 1px;
		}
	</style>
	<!--<form method="post" action="users">-->
	<div>
		Имя: <input id="name" name="name" />
		Фамилия: <input id="s_name" name="name" />
		<button id="submit">Добавить чела</button>
	</div>
	<div>
		<table id="info" border="1">
			<th>ID</th>
			<th>Имя</th>
			<th>Фамилия</th>
		</table>
	</div>

	<!--</form>-->
	<script>
		let bt_del = "<button class='bt_del'>Удалить</button>"
		let headers = { "Accept": "application/json", "Content-Type": "application/json" }
		document.getElementById("submit").addEventListener("click", add)
		

		///////////////////////////////////////////////////////////////////////////////

		async function add() {
			let responce = await fetch("/api", {
				method: "POST",
				headers: headers,
				body: JSON.stringify({
					name: document.getElementById("name").value,
                    s_name: document.getElementById("s_name").value
					})
			})
			let Person = await responce.json();

			let string = "<tr><td class = 'id'>" + Person.id + "<td class = 'name'>" + Person.name + "</td><td> " + Person.s_name + "</td><td>" + bt_del + "</td>";

			document.getElementById("info").innerHTML += string;
			//document.getElementById("i").addEventListener("click", del(this.id))
			document.getElementsByClassName("bt_del")[document.getElementsByClassName.length-1].addEventListener("click", del(Person))
			//document.getElementById("i").id = Person.id;
		}

        async function getAll() {
			let r = await fetch("/api")
			return r.json()
        }

		async function del(dude) {
			await fetch("/api", {
				method: "DEL",
				headers: headers,
				body: JSON.stringify(dude)
			})
		}
	</script>
</body>
</html>
	